import{d as I,I as M,r as m,J as F,f as c,c as C,e,x as g,t as f,b as s,v as $,k as N,F as B,i as x,w as n,q,h as b,u as Z,_ as L,m as j,K as O,n as W,L as ee,z as G,G as D,D as H,A as U,l as R,j as X,M as z,O as ae,s as te,o as se,al as le,V as Y,am as oe,g as ne}from"./index-DD0chK9m.js";import{P as re}from"./PlayerModalDialog-e3S7FNpc.js";import{V as J}from"./VSpacer-DKUpOtpE.js";import{V as K}from"./VDialog-8pvQ3nO6.js";import{V as de}from"./VFileInput-DO4WOKog.js";import{V as ie}from"./VAlert-BswZB0pH.js";import{V as ue}from"./VAutocomplete-CIS9KaFs.js";import"./dialog-transition-ChtNxUt0.js";import"./VSelect-BpGEebQz.js";const me={class:"team-header-card"},ce={class:"team-title-section"},pe={class:"team-title"},ve={key:0,class:"edit-controls"},_e={class:"players-showcase"},fe={class:"players-grid"},ye=["onClick"],ge={class:"player-name"},he=I({__name:"TeamHeader",props:{team:{}},emits:["update:team","refresh","openNameEdit","openLogoEdit","openAddPlayerDialog","player-click","show-player"],setup(A,{emit:P}){const a=M();m(!1),m(!1),m(""),m(null),m(""),m(""),m(!1),m(""),m("");const l=F(()=>a.isAuthenticated?a.userRole==="admin"||a.userRole==="director":!1),t=P,p=()=>{t("openNameEdit")},h=()=>{t("openLogoEdit")},v=w=>{t("player-click",w)},k=w=>{t("show-player",w)},V=async()=>{t("openAddPlayer")};return(w,_)=>(c(),C("div",me,[e("div",ce,[e("h1",pe,[g(f(w.team.name)+" ",1),l.value?(c(),C("div",ve,[s($,{icon:"mdi-pencil",class:"edit-icon ml-2",onClick:p,size:"26"}),s($,{icon:"mdi-camera",class:"edit-icon ml-2",onClick:h,size:"26"})])):N("",!0)])]),e("div",_e,[e("div",fe,[(c(!0),C(B,null,x(w.team.players,i=>(c(),C("div",{key:i.id,class:"player-item",onClick:r=>k(i)},[s(q,{size:"80",class:"player-avatar",onClick:r=>v(i.id)},{default:n(()=>[i.avatar?(c(),b(Z,{key:0,src:i.avatar,alt:i.username},null,8,["src","alt"])):(c(),b($,{key:1,icon:"mdi-account",color:"#42DDF2FF",size:"40"}))]),_:2},1032,["onClick"]),e("span",ge,f(i.username),1)],8,ye))),128)),l.value?(c(),C("div",{key:0,class:"player-item add-player",onClick:V},[s(q,{size:"80",class:"player-avatar add-avatar"},{default:n(()=>[s($,{icon:"mdi-plus",color:"#42DDF2FF",size:"40"})]),_:1}),_[0]||(_[0]=e("span",{class:"player-name"},"Add Player",-1))])):N("",!0)])])]))}}),Ve=L(he,[["__scopeId","data-v-9e8fde3f"]]),we=I({__name:"TeamNameDialog",props:{modelValue:{type:Boolean},teamId:{},currentName:{}},emits:["update:modelValue","nameUpdated"],setup(A,{emit:P}){const a=A,l=P,t=m(a.currentName),p=m(""),h=M(),v={required:r=>!!(r!=null&&r.trim())||"Team name is required",minLength:r=>((r==null?void 0:r.trim().length)||0)>=5||"Team name must be at least 5 characters"},k=F({get:()=>a.modelValue,set:r=>l("update:modelValue",r)}),V=F(()=>{var o;const r=((o=t.value)==null?void 0:o.trim())||"";return v.required(r)===!0&&v.minLength(r)===!0}),w=F(()=>{var r,o;return((r=t.value)==null?void 0:r.trim())!==((o=a.currentName)==null?void 0:o.trim())}),_=()=>{t.value=a.currentName,p.value="",k.value=!1},i=async()=>{var o;const r=(o=t.value)==null?void 0:o.trim();if(!V.value){p.value=r?"Team name must be at least 5 characters":"Team name is required";return}try{p.value="";const d=await fetch(`${U}/teams/${a.teamId}?name=${encodeURIComponent(r)}`,{method:"PUT",headers:{Authorization:`Bearer ${h.token}`}});if(!d.ok){const T=await d.text();throw new Error(T)}l("nameUpdated",r),_()}catch(d){console.error("Error updating team name:",d),p.value=d.message||"Failed to update team name"}};return j(()=>a.modelValue,r=>{r&&(t.value=a.currentName,p.value="")}),(r,o)=>(c(),b(K,{modelValue:k.value,"onUpdate:modelValue":o[1]||(o[1]=d=>k.value=d),"max-width":"500px",class:"edit-dialog"},{default:n(()=>[s(H,null,{default:n(()=>[s(O,{class:"dialog-title"},{default:n(()=>o[2]||(o[2]=[g("Edit Team Name")])),_:1}),s(W,null,{default:n(()=>[s(ee,{modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=d=>t.value=d),label:"Team Name",variant:"outlined",rules:[v.required,v.minLength],error:!!p.value,"error-messages":p.value},null,8,["modelValue","rules","error","error-messages"])]),_:1}),s(G,null,{default:n(()=>[s(J),s(D,{class:"cancel-btn",onClick:_},{default:n(()=>o[3]||(o[3]=[g("Cancel")])),_:1}),s(D,{class:"submit-btn",onClick:i,disabled:!V.value||!w.value},{default:n(()=>o[4]||(o[4]=[g(" Save ")])),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),ke=L(we,[["__scopeId","data-v-fecb1c99"]]),be={class:"team-content-wrapper"},Pe={class:"stats-card"},Ce={class:"section-title"},$e={class:"stats-list"},Te={class:"stat-item"},Ee={class:"stat-value"},Ae={class:"stat-item"},Ne={class:"stat-value glow-text"},Fe={class:"stat-item"},De={class:"stat-value"},Ue={class:"stats-card"},Ie={class:"section-title"},Le={class:"stats-list"},Se={class:"stat-item"},Re={class:"stat-value"},ze={class:"stat-item"},Be={class:"stat-value glow-text"},Me={class:"stat-item"},xe={class:"stat-value"},qe={class:"stats-card"},je={class:"section-title"},Oe={class:"stats-list"},We={class:"stat-item"},Ge={class:"stat-value"},He={class:"stat-item"},Je={class:"stat-value accent-text"},Ke={class:"stat-item"},Qe={class:"stat-value"},Xe={class:"content-card"},Ye={class:"section-title"},Ze={class:"prizes-list"},ea={class:"prize-trophy"},aa={class:"prize-details"},ta={class:"tournament-name"},sa={class:"prize-place"},la={class:"content-card"},oa={class:"section-title"},na={class:"matches-list"},ra={class:"match-teams"},da={class:"match-info"},ia={class:"tournament-name"},ua={class:"match-stage"},ma=I({__name:"TeamContentGrid",props:{team:{}},setup(A){const P=a=>a===1?"1st":a===2?"2nd":a===3?"3rd":`${a}th`;return(a,l)=>(c(),C("div",be,[s(X,{class:"mt-6"},{default:n(()=>[s(R,{cols:"12",md:"4"},{default:n(()=>[e("div",Pe,[e("h3",Ce,[s($,{icon:"mdi-trophy",class:"mr-2"}),l[0]||(l[0]=g(" Match Performance "))]),e("div",$e,[e("div",Te,[l[1]||(l[1]=e("span",{class:"stat-label"},"Matches Played",-1)),e("span",Ee,f(a.team.team_stats.matches_played),1)]),e("div",Ae,[l[2]||(l[2]=e("span",{class:"stat-label"},"Matches Won",-1)),e("span",Ne,f(a.team.team_stats.matches_won),1)]),e("div",Fe,[l[3]||(l[3]=e("span",{class:"stat-label"},"Win/Loss Ratio",-1)),e("span",De,f(a.team.team_stats.match_win_loss_ratio.ratio),1)])])])]),_:1}),s(R,{cols:"12",md:"4"},{default:n(()=>[e("div",Ue,[e("h3",Ie,[s($,{icon:"mdi-medal",class:"mr-2"}),l[4]||(l[4]=g(" Tournament Stats "))]),e("div",Le,[e("div",Se,[l[5]||(l[5]=e("span",{class:"stat-label"},"Tournaments Played",-1)),e("span",Re,f(a.team.team_stats.tournaments_played),1)]),e("div",ze,[l[6]||(l[6]=e("span",{class:"stat-label"},"Tournaments Won",-1)),e("span",Be,f(a.team.team_stats.tournaments_won),1)]),e("div",Me,[l[7]||(l[7]=e("span",{class:"stat-label"},"Win/Loss Ratio",-1)),e("span",xe,f(a.team.team_stats.tournament_win_loss_ratio.ratio),1)])])])]),_:1}),s(R,{cols:"12",md:"4"},{default:n(()=>[e("div",qe,[e("h3",je,[s($,{icon:"mdi-sword-cross",class:"mr-2"}),l[8]||(l[8]=g(" Rival Analysis "))]),e("div",Oe,[e("div",We,[l[9]||(l[9]=e("span",{class:"stat-label"},"Most Frequent Rival",-1)),e("span",Ge,f(a.team.team_stats.most_often_played_opponent||"N/A"),1)]),e("div",He,[l[10]||(l[10]=e("span",{class:"stat-label"},"Strongest Rival",-1)),e("span",Je,f(a.team.team_stats.best_opponent||"N/A"),1)]),e("div",Ke,[l[11]||(l[11]=e("span",{class:"stat-label"},"Favorable Matchup",-1)),e("span",Qe,f(a.team.team_stats.worst_opponent||"N/A"),1)])])])]),_:1})]),_:1}),s(X,{class:"mt-6"},{default:n(()=>[s(R,{cols:"12",md:"6"},{default:n(()=>[e("div",Xe,[e("h3",Ye,[s($,{icon:"mdi-cat",class:"mr-2"}),l[12]||(l[12]=g(" Achievement Showcase "))]),e("div",Ze,[(c(!0),C(B,null,x(a.team.prize_cuts,t=>(c(),C("div",{key:t.id,class:z(["prize-item",{gold:t.place===1,silver:t.place===2}])},[e("div",ea,[s($,{icon:t.place===1?"mdi-trophy":"mdi-trophy-variant",size:"32",color:t.place===1?"#FED854FF":"#C0C0C0"},null,8,["icon","color"])]),e("div",aa,[e("span",ta,f(t.tournament_name),1),e("span",sa,f(P(t.place))+" Place",1)])],2))),128))])])]),_:1}),s(R,{cols:"12",md:"6"},{default:n(()=>[e("div",la,[e("h3",oa,[s($,{icon:"mdi-sword",class:"mr-2"}),l[13]||(l[13]=g(" Recent Matches "))]),e("div",na,[(c(!0),C(B,null,x(a.team.matches,t=>(c(),C("div",{key:t.id,class:z(["match-item",{"match-won":t.winner_id===a.team.id}])},[e("div",ra,[e("span",{class:z(["team1",{winner:t.winner_id===t.team1_id}])},f(t.team1_name),3),l[14]||(l[14]=e("span",{class:"vs"},"vs",-1)),e("span",{class:z(["team2",{winner:t.winner_id===t.team2_id}])},f(t.team2_name),3)]),e("div",da,[e("span",ia,f(t.tournament_title),1),e("span",ua,f(t.stage),1)]),e("div",{class:z(["match-result",{won:t.winner_id===a.team.id}])},f(t.winner_id===a.team.id?"Victory":"Defeat"),3)],2))),128))])])]),_:1})]),_:1})]))}}),ca=L(ma,[["__scopeId","data-v-0dc6d306"]]),pa=I({__name:"TeamLogoDialog",props:{modelValue:{type:Boolean},teamId:{}},emits:["update:modelValue","logoUpdated"],setup(A,{emit:P}){const a=A,l=P,t=m(null),p=m(""),h=m(""),v=M(),k=F({get:()=>a.modelValue,set:_=>l("update:modelValue",_)}),V=()=>{t.value=null,p.value="",h.value="",k.value=!1},w=async()=>{if(!t.value){h.value="Please select a logo image";return}try{p.value="",h.value="";const _=new FormData;_.append("logo",t.value);const i=await fetch(`${U}/teams/${a.teamId}`,{method:"PUT",headers:{Authorization:`Bearer ${v.token}`},body:_});if(!i.ok){const r=await i.text();throw new Error(r)}l("logoUpdated"),V()}catch(_){console.error("Error updating team logo:",_),p.value=_.message||"Failed to update team logo"}};return j(()=>a.modelValue,_=>{_||(t.value=null,p.value="",h.value="")}),(_,i)=>(c(),b(K,{modelValue:k.value,"onUpdate:modelValue":i[1]||(i[1]=r=>k.value=r),"max-width":"500px",class:"edit-dialog"},{default:n(()=>[s(H,null,{default:n(()=>[s(O,{class:"dialog-title"},{default:n(()=>i[2]||(i[2]=[g("Update Team Logo")])),_:1}),s(W,null,{default:n(()=>[p.value?(c(),b(ee,{key:0,type:"error",variant:"tonal",class:"mb-4",messages:p.value},null,8,["messages"])):N("",!0),s(de,{modelValue:t.value,"onUpdate:modelValue":i[0]||(i[0]=r=>t.value=r),label:"Choose logo",accept:"image/*",variant:"outlined","prepend-icon":"mdi-camera","error-messages":h.value},null,8,["modelValue","error-messages"])]),_:1}),s(G,null,{default:n(()=>[s(J),s(D,{class:"cancel-btn",onClick:V},{default:n(()=>i[3]||(i[3]=[g("Cancel")])),_:1}),s(D,{class:"submit-btn",disabled:!t.value,onClick:w},{default:n(()=>i[4]||(i[4]=[g(" Save ")])),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),va=L(pa,[["__scopeId","data-v-13dacbe3"]]),_a=I({__name:"TeamAddPlayerDialog",props:{modelValue:{type:Boolean},teamId:{},teamName:{}},emits:["update:modelValue","playerAdded"],setup(A,{emit:P}){const a=A,l=P,t=m(""),p=m([]),h=m(!1),v=m(""),k=M(),V=F({get:()=>a.modelValue,set:o=>l("update:modelValue",o)}),w=o=>o.includes("Team has reached the player limit")?"Team limit reached!":o,_=async()=>{try{h.value=!0,v.value="";const o=await fetch(`${U}/players/?is_available=true&offset=0&limit=100`);if(!o.ok)throw new Error("Failed to load available players");p.value=await o.json()}catch(o){console.error("Error fetching available players:",o),v.value="Failed to load available players"}finally{h.value=!1}},i=()=>{t.value="",v.value="",V.value=!1},r=async()=>{if(t.value)try{v.value="";const o=await fetch(`${U}/players/${t.value}?team_name=${encodeURIComponent(a.teamName)}`,{method:"PUT",headers:{Authorization:`Bearer ${k.token}`}});if(!o.ok){const d=await o.text();throw new Error(d)}V.value=!1,l("playerAdded")}catch(o){console.error("Error adding player:",o),v.value=o.message||"Failed to add player"}};return j(()=>a.modelValue,o=>{o&&(_(),t.value="",v.value="")}),(o,d)=>(c(),b(K,{modelValue:V.value,"onUpdate:modelValue":d[1]||(d[1]=T=>V.value=T),"max-width":"500px",class:"edit-dialog"},{default:n(()=>[s(H,null,{default:n(()=>[s(O,{class:"dialog-title"},{default:n(()=>d[2]||(d[2]=[g("Add Player to Team")])),_:1}),s(W,null,{default:n(()=>[v.value?(c(),b(ie,{key:0,type:"error",variant:"tonal",class:"mb-4 error-alert",closable:""},{default:n(()=>[g(f(w(v.value)),1)]),_:1})):N("",!0),s(ue,{modelValue:t.value,"onUpdate:modelValue":d[0]||(d[0]=T=>t.value=T),items:p.value,"item-title":"username","item-value":"id",label:"Select Player",variant:"outlined",loading:h.value},{item:n(({props:T,item:S})=>[s(ae,te(T,{title:S.raw.username}),{prepend:n(()=>[s(q,{size:"32"},{default:n(()=>[S.raw.avatar?(c(),b(Z,{key:0,src:S.raw.avatar},null,8,["src"])):(c(),b($,{key:1},{default:n(()=>d[3]||(d[3]=[g("mdi-account")])),_:1}))]),_:2},1024)]),_:2},1040,["title"])]),_:1},8,["modelValue","items","loading"])]),_:1}),s(G,null,{default:n(()=>[s(J),s(D,{class:"cancel-btn",onClick:i},{default:n(()=>d[4]||(d[4]=[g("Cancel")])),_:1}),s(D,{class:"submit-btn",disabled:!t.value,onClick:r},{default:n(()=>d[5]||(d[5]=[g(" Add Player ")])),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),fa=L(_a,[["__scopeId","data-v-33b6a2d7"]]),ya={class:"team-wrapper"},ga={class:"content-wrapper"},ha={key:1,class:"loading-container"},Va=I({__name:"SingleTeam",setup(A){const P=oe(),a=m(null),l=m(!0),t=m(null),p=m(!1),h=m(null),v=m(!1),k=m(!1),V=m(!1),w=m(!1),_=async()=>{try{await d()}catch(y){console.error("Error adding player:",y)}},i=async()=>{try{await d()}catch(y){console.error("Error updating logo:",y)}},r=async y=>{try{a.value&&(a.value.name=y),await d()}catch(u){console.error("Error handling name update:",u)}},o=y=>{T(y),v.value=!0},d=async()=>{try{l.value=!0,console.log("Fetching team details..."),console.log("Team ID:",P.params.id);const y=await fetch(`${U}/teams/${P.params.id}`);if(console.log("Response:",y),!y.ok)throw new Error("Failed to fetch team details");const u=await y.json();console.log("Team data:",u),a.value=u}catch(y){console.error("Error fetching team details:",y),t.value="Failed to load team details"}finally{l.value=!1}},T=async y=>{try{const u=await fetch(`${U}/players/${y}`);if(!u.ok)throw new Error(`HTTP error! status: ${u.status}`);h.value=await u.json()}catch(u){console.error("Error fetching player:",u)}},S=y=>{T(y.id),p.value=!0};return se(d),(y,u)=>{var Q;return c(),C(B,null,[e("div",ya,[e("div",{class:"header-image",style:le({backgroundImage:`url(${(Q=a.value)==null?void 0:Q.logo})`})},null,4),u[7]||(u[7]=e("div",{class:"header-overlay"},null,-1)),e("div",ga,[a.value?(c(),b(Y,{key:0},{default:n(()=>[s(Ve,{team:a.value,onRefresh:d,onPlayerClick:o,onShowPlayer:S,onOpenNameEdit:u[0]||(u[0]=E=>k.value=!0),onOpenLogoEdit:u[1]||(u[1]=E=>V.value=!0),onOpenAddPlayer:u[2]||(u[2]=E=>w.value=!0)},null,8,["team"]),s(ca,{team:a.value},null,8,["team"])]),_:1})):l.value?(c(),C("div",ha,[s(ne,{indeterminate:"",color:"#42DDF2FF"})])):N("",!0)]),s(re,{modelValue:v.value,"onUpdate:modelValue":u[3]||(u[3]=E=>v.value=E),player:h.value},null,8,["modelValue","player"])]),a.value?(c(),b(Y,{key:0},{default:n(()=>[s(ke,{modelValue:k.value,"onUpdate:modelValue":u[4]||(u[4]=E=>k.value=E),"team-id":a.value.id,"current-name":a.value.name,onNameUpdated:r},null,8,["modelValue","team-id","current-name"]),a.value?(c(),b(va,{key:0,modelValue:V.value,"onUpdate:modelValue":u[5]||(u[5]=E=>V.value=E),"team-id":a.value.id,onLogoUpdated:i},null,8,["modelValue","team-id"])):N("",!0),a.value?(c(),b(fa,{key:1,modelValue:w.value,"onUpdate:modelValue":u[6]||(u[6]=E=>w.value=E),"team-id":a.value.id,"team-name":a.value.name,onPlayerAdded:_},null,8,["modelValue","team-id","team-name"])):N("",!0)]),_:1})):N("",!0)],64)}}}),Na=L(Va,[["__scopeId","data-v-f595d47c"]]);export{Na as default};
