import{d as E,r as c,m as W,f as d,h as _,w as i,b as l,l as D,j as R,_ as P,e as m,t as w,n as X,p as j,q as x,s as H,u as B,v as L,x as I,y as Y,z as Z,B as ee,C as ae,D as te,o as se,a as oe,c as k,V as re,A as V,g as le,F as ne,i as ie,k as ce}from"./index-DD0chK9m.js";import{H as ue}from"./HeaderSection-BqWuRDgu.js";import{V as C}from"./VSelect-BpGEebQz.js";import{L as me}from"./LoadMoreButton-Cql9AWZ4.js";import{M as de}from"./MatchModalDialog-B5BSXzHQ.js";import"./dialog-transition-ChtNxUt0.js";import"./VDialog-8pvQ3nO6.js";import"./VAlert-BswZB0pH.js";import"./VSpacer-DKUpOtpE.js";import"./VForm-D4HHFwdz.js";import"./VAutocomplete-CIS9KaFs.js";const he=E({__name:"MatchFilterBar",props:{teams:{}},emits:["filter-change"],setup(S,{emit:u}){const g=u,v=c(null),s=c(null),n=c(null),h=[{text:"Group Stage",value:"group stage"},{text:"Quarter Final",value:"quarter final"},{text:"Semi Final",value:"semi final"},{text:"Final",value:"final"}],$=[{text:"Active",value:"active"},{text:"Finished",value:"finished"}],y=()=>{g("filter-change",{stage:v.value,status:s.value,team:n.value})};return W([v,s,n],()=>{y()}),(p,f)=>(d(),_(R,{class:"filter-row"},{default:i(()=>[l(D,{cols:"12",md:"3"},{default:i(()=>[l(C,{modelValue:v.value,"onUpdate:modelValue":[f[0]||(f[0]=F=>v.value=F),y],items:h,"item-title":"text","item-value":"value",label:"Stage",variant:"outlined",density:"comfortable","bg-color":"rgba(45, 55, 75, 0.4)",color:"#42DDF2FF",clearable:""},null,8,["modelValue"])]),_:1}),l(D,{cols:"12",md:"3"},{default:i(()=>[l(C,{modelValue:s.value,"onUpdate:modelValue":[f[1]||(f[1]=F=>s.value=F),y],items:$,"item-title":"text","item-value":"value",label:"Status",variant:"outlined",density:"comfortable","bg-color":"rgba(45, 55, 75, 0.4)",color:"#42DDF2FF",clearable:""},null,8,["modelValue"])]),_:1}),l(D,{cols:"12",md:"3"},{default:i(()=>[l(C,{modelValue:n.value,"onUpdate:modelValue":[f[2]||(f[2]=F=>n.value=F),y],items:p.teams,"item-title":"text","item-value":"value",label:"Team",variant:"outlined",density:"comfortable","bg-color":"rgba(45, 55, 75, 0.4)",color:"#42DDF2FF",clearable:""},null,8,["modelValue","items"])]),_:1})]),_:1}))}}),fe=P(he,[["__scopeId","data-v-39c5f4a3"]]),ve={class:"match-card-content match-list-card"},pe={class:"tournament-header-section"},_e={class:"match-card-tournament-title"},ge={class:"tournament-format"},ye={class:"match-layout"},we={class:"team-info-left"},Fe={class:"team-score"},Me={class:"team-info-right"},Ve={class:"team-score"},$e={class:"time-text"},ke=E({__name:"MatchCard",props:{match:{},tournamentFormat:{}},emits:["open-match-dialog"],setup(S,{emit:u}){const g=u,v=s=>{g("open-match-dialog",s)};return(s,n)=>(d(),_(te,{class:"match-card",onClick:n[0]||(n[0]=h=>v(s.match))},{default:i(()=>[m("div",ve,[m("div",pe,[m("h3",_e,w(s.match.tournament_title),1),m("div",ge,w(s.tournamentFormat.toUpperCase()),1)]),l(X,null,{default:i(()=>[m("div",ye,[m("div",we,[l(j,{location:"top"},{activator:i(({props:h})=>[l(x,H({class:"team-avatar",size:"60"},h),{default:i(()=>[s.match.team1_logo?(d(),_(B,{key:0,src:s.match.team1_logo,alt:s.match.team1_name},null,8,["src","alt"])):(d(),_(L,{key:1,icon:"mdi-account",color:"#42DDF2FF",size:"40"}))]),_:2},1040)]),default:i(()=>[I(" "+w(s.match.team1_name),1)]),_:1}),m("span",Fe,w(s.match.team1_score),1)]),n[1]||(n[1]=m("div",{class:"score-divider"},":",-1)),m("div",Me,[m("span",Ve,w(s.match.team2_score),1),l(j,{location:"top"},{activator:i(({props:h})=>[l(x,H({class:"team-avatar",size:"60"},h),{default:i(()=>[s.match.team2_logo?(d(),_(B,{key:0,src:s.match.team2_logo,alt:s.match.team2_name},null,8,["src","alt"])):(d(),_(L,{key:1,icon:"mdi-account",color:"#42DDF2FF",size:"40"}))]),_:2},1040)]),default:i(()=>[I(" "+w(s.match.team2_name),1)]),_:1})])])]),_:1}),l(Y,{class:"match-divider"}),l(Z,{class:"justify-center pa-4"},{default:i(()=>[l(L,{icon:"mdi-clock-outline",class:"mr-2 neon-text"}),m("span",$e,w(ee(ae)(new Date(s.match.start_time),"HH:mm, dd MMM yyyy")),1)]),_:1})])]),_:1}))}}),De=P(ke,[["__scopeId","data-v-f5f9d3c3"]]),Te={class:"match-list-wrapper"},be={class:"content-wrapper"},Le={key:0,class:"d-flex justify-center align-center",style:{height:"200px"}},Ce={key:1,class:"error-text pa-4"},Ee={class:"load-more-wrapper"},Pe=E({__name:"MatchList",setup(S){const u=c([]),g=c([]),v=c([]),s=c(!1),n=c(null),h=c(!0),$=c(!1),y=c(!1),p=c(null),f=c(10),F=c(""),r=c({stage:null,status:null,team:null}),z=()=>new URLSearchParams(window.location.search).get("search")||"",N=async a=>{try{F.value="",r.value=a,s.value=!0,n.value=null,f.value=10;const e=new URLSearchParams;e.append("offset","0"),e.append("limit",f.value.toString()),a.stage&&e.append("stage",a.stage),a.status==="active"&&e.append("is_finished","false"),a.status==="finished"&&e.append("is_finished","true"),a.team&&e.append("team_name",a.team);const t=await fetch(`${V}/matches/?${e}`);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const o=await t.json(),M=Array.isArray(o)?o:o.results||[];u.value=M,h.value=M.length===f.value}catch(e){console.error("Error fetching matches:",e),n.value="Failed to load matches. Please try again later."}finally{s.value=!1}},A=async(a=!1)=>{try{a?$.value=!0:s.value=!0,n.value=null;const e=new URLSearchParams,t=a?u.value.length:0;e.append("offset",t.toString()),e.append("limit","10");const o=z();o&&e.append("search",o),r.value.stage&&e.append("stage",r.value.stage),r.value.status==="active"&&e.append("is_finished","false"),r.value.status==="finished"&&e.append("is_finished","true"),r.value.team&&e.append("team_name",r.value.team);const M=await fetch(`${V}/matches/?${e}`);if(!M.ok)throw new Error(`HTTP error! status: ${M.status}`);const T=await M.json(),b=Array.isArray(T)?T:T.results||[];a?u.value=[...u.value,...b]:u.value=b,h.value=b.length===10}catch(e){console.error("Error fetching matches:",e),n.value="Failed to load matches. Please try again later."}finally{s.value=!1,$.value=!1}},q=async()=>{await A(!0)},U=async()=>{try{const a=await fetch(`${V}/tournaments/?offset=0&limit=100`);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const e=await a.json();g.value=Array.isArray(e)?e:e.results||[]}catch(a){console.error("Error fetching tournaments:",a)}},O=async()=>{if(p.value)try{const a=await fetch(`${V}/matches/${p.value.id}`);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const e=await a.json();u.value=u.value.map(t=>t.id===e.id?e:t),p.value=e}catch(a){console.error("Error refreshing match:",a)}},G=async()=>{try{const a=await fetch(`${V}/teams/?offset=0&limit=100`);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const e=await a.json(),t=Array.isArray(e)?e:e.results||[];v.value=t.map(o=>({text:o.name,value:o.name}))}catch(a){console.error("Error fetching teams:",a)}},Q=async a=>{try{await U();const e=await fetch(`${V}/matches/${a.id}`);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);p.value=await e.json(),y.value=!0}catch(e){console.error("Error fetching match details:",e)}},J=a=>{const e=g.value.find(t=>t.id===a);return e?e.tournament_format:"Unknown Format"},K=a=>{if(!a)return"";console.log("Looking for tournament with ID:",a),console.log("Available tournaments:",g.value);const e=g.value.find(t=>t.id===a);return console.log("Full tournament object:",e),(e==null?void 0:e.director_id)||""};return se(()=>{A(),U(),G(),window.addEventListener("search-results",a=>{if(a.detail.route==="/matches"){const e=a.detail.results.filter(t=>{let o=!0;return r.value.stage&&(o=o&&t.stage===r.value.stage),r.value.status==="active"&&(o=o&&!t.is_finished),r.value.status==="finished"&&(o=o&&t.is_finished),r.value.team&&(o=o&&(t.team1_name===r.value.team||t.team2_name===r.value.team)),o});u.value=e,s.value=!1,n.value=null}})}),oe(()=>{window.removeEventListener("search-results",a=>{if(a.detail.route==="/matches"){const e=a.detail.results.filter(t=>{let o=!0;return r.value.stage&&(o=o&&t.stage===r.value.stage),r.value.status==="active"&&(o=o&&!t.is_finished),r.value.status==="finished"&&(o=o&&t.is_finished),r.value.team&&(o=o&&(t.team1_name===r.value.team||t.team2_name===r.value.team)),o});u.value=e,s.value=!1,n.value=null}})}),(a,e)=>(d(),k("div",Te,[l(ue),m("div",be,[l(re,null,{default:i(()=>[l(fe,{teams:v.value,onFilterChange:N},null,8,["teams"]),s.value?(d(),k("div",Le,[l(le,{indeterminate:"",color:"#00ff9d"})])):n.value?(d(),k("div",Ce,w(n.value),1)):(d(),_(R,{key:2,justify:"center"},{default:i(()=>[(d(!0),k(ne,null,ie(u.value,t=>(d(),_(D,{key:t.id,cols:"12",md:"6",class:"match-column"},{default:i(()=>[l(De,{match:t,"tournament-format":J(t.tournament_id),onOpenMatchDialog:Q},null,8,["match","tournament-format"])]),_:2},1024))),128))]),_:1})),l(de,{modelValue:y.value,"onUpdate:modelValue":e[0]||(e[0]=t=>y.value=t),match:p.value,tournamentDirectorId:p.value?K(p.value.tournament_id):"",onMatchUpdate:O},null,8,["modelValue","match","tournamentDirectorId"]),m("div",Ee,[!s.value&&h.value?(d(),_(me,{key:0,"is-loading":$.value,"button-text":"Load More Matches",onLoadMore:q},null,8,["is-loading"])):ce("",!0)])]),_:1})])]))}}),qe=P(Pe,[["__scopeId","data-v-b71fc8ca"]]);export{qe as default};
