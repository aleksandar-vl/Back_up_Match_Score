import{d as E,r as t,o as V,a as A,c as v,b as f,e as R,w as _,V as B,F as T,A as C,f as i,g as M,t as U,h as w,i as $,j,k as H,l as b,_ as N}from"./index-DD0chK9m.js";import{F as I,T as q}from"./TournamentCard-Ch5eX-qp.js";import{H as D}from"./HeaderSection-BqWuRDgu.js";import{L as z}from"./LoadMoreButton-Cql9AWZ4.js";import"./VSelect-BpGEebQz.js";import"./dialog-transition-ChtNxUt0.js";const G={class:"content-wrapper"},J={key:0,class:"d-flex justify-center align-center",style:{height:"200px"}},K={key:1,class:"error-text pa-4"},O=E({__name:"TournamentList",setup(Q){const y=t(!1),n=t([]),o=t(!1),l=t(null),m=t(10),h=t(!0),g=t(!1),F=t(null),P=t(null),k=t(null);t("");const s=t({period:null,status:null,format:null}),p=()=>new URLSearchParams(window.location.search).get("search")||"",S=async a=>{console.log("handleFiltersChange called with filters:",a),console.log("Current search term:",p());try{s.value=a,o.value=!0,l.value=null,m.value=10;const e=new URLSearchParams;e.append("offset","0"),e.append("limit",m.value.toString());const r=p();r&&e.append("search",r),a.period&&e.append("period",a.period),a.status&&e.append("status",a.status),a.format&&e.append("tournament_format",a.format);const u=await fetch(`${C}/tournaments/?${e}`);if(!u.ok)throw new Error(`HTTP error! status: ${u.status}`);const c=await u.json(),d=Array.isArray(c)?c:c.results||[];n.value=d,y.value=!!(F.value||P.value||k.value),h.value=d.length===m.value}catch(e){console.error("Error fetching tournaments:",e),l.value="Failed to load tournaments. Please try again later."}finally{o.value=!1}},L=async(a=!1)=>{console.log("fetchTournaments called, loadMore:",a),console.log("Current filters:",s.value),console.log("Current search:",p());try{a?g.value=!0:(o.value=!0,y.value=!1),l.value=null;const e=new URLSearchParams;e.append("offset","0"),e.append("limit",m.value.toString());const r=p();r&&(e.append("search",r),console.log("Adding search term to request:",r)),s.value.period&&e.append("period",s.value.period),s.value.status&&e.append("status",s.value.status),s.value.format&&e.append("tournament_format",s.value.format);const u=await fetch(`${C}/tournaments/?${e}`);if(!u.ok)throw new Error(`HTTP error! status: ${u.status}`);const c=await u.json(),d=Array.isArray(c)?c:c.results||[];a?n.value=[...n.value,...d]:n.value=d,h.value=d.length===10}catch(e){console.error("Error fetching tournaments:",e),l.value="Failed to load tournaments. Please try again later."}finally{o.value=!1,g.value=!1}},x=async()=>{m.value+=10,await L(!0)};return V(()=>{L(),window.addEventListener("search-results",a=>{if(a.detail.route==="/events"){const e=a.detail.results.filter(r=>s.value.format?r.tournament_format===s.value.format:!0);n.value=e,o.value=!1,l.value=null}})}),A(()=>{window.removeEventListener("search-results",a=>{a.detail.route==="/events"&&(n.value=a.detail.results)})}),(a,e)=>(i(),v(T,null,[f(D),R("div",G,[f(B,null,{default:_(()=>[f(I,{onFilterChange:S}),o.value?(i(),v("div",J,[f(M,{indeterminate:"",color:"#00ff9d"})])):l.value?(i(),v("div",K,U(l.value),1)):(i(),w(j,{key:2},{default:_(()=>[(i(!0),v(T,null,$(n.value,r=>(i(),w(b,{key:r.id,cols:"12",md:"6",class:"tournament-column"},{default:_(()=>[f(q,{tournament:r},null,8,["tournament"])]),_:2},1024))),128))]),_:1})),!o.value&&h.value?(i(),w(z,{key:3,"is-loading":g.value,"button-text":"Load More Tournaments",onLoadMore:x},null,8,["is-loading"])):H("",!0)]),_:1})])],64))}}),te=N(O,[["__scopeId","data-v-4cba0dc9"]]);export{te as default};
